%
% Elecnor Deimos
%
% Data Exchange Component
%
% Borja Lopez Fernandez (BOLF)
%
% DEC Troubleshooting
%

\documentclass[dec_sum_main.tex]{subfiles}
 
\begin{document}

% ------------------------------------------------------------------------------
% Information Log Messages

\section{Information Messages}

\subsection{Scope}
The information messages by DEC SW are meant in general for tracing the nominal performed circulations allowing consumers to monitor them.

\subsection{Index of Messages}

\begin{itemize}
	\item \textbf{[DEC\_005]} I/F "interface": Polling Started
	\item \textbf{[DEC\_050]} I/F "interface": Polling Completed / No file(s) available for pull	
	\item \textbf{[DEC\_060]} I/F "interface": Polling Completed / New file(s) available for pull
	\item \textbf{[DEC\_105]} I/F "interface": "filename" is available
	\item \textbf{[DEC\_110]} I/F "interface": Downloaded "filename" with size "num\_bytes" bytes
	\item \textbf{[DEC\_115]} Disseminated "filename" into "directory" Intray
	\item \textbf{[DEC\_116]} Compressed "filename" in "method" at "directory" Intray
	\item \textbf{[DEC\_120]} I/F "interface": Deleting unknown file "filename" available
	\item \textbf{[DEC\_125]} I/F "interface": Deleting duplicated file "filename" previously received 
	\item \textbf{[DEC\_126]} I/F "interface": Deleted downloaded file "filename"
	\item \textbf{[DEC\_130]} I/F "interface": event "name" triggered  	
	\item \textbf{[DEC\_131]} I/F "interface": event NewFile2Intray triggered
	\item \textbf{[DEC\_210]} I/F "interface": File "filename" sent using "protocol"  	
	\item \textbf{[DEC\_211]} TBW
	\item \textbf{[DEC\_212]} TBW
	\item \textbf{[DEC\_213]} TBW
	\item \textbf{[DEC\_214]} TBW	
\end{itemize}

\label{DEC005}
\subsection{[DEC\_005] Interface Polling Start}
This message time tags the start of the polling operation to \textit{pull} files from a given interface. The time to poll and filter the file to be pulled depends on the number of files published, the different rules configured for download or / and verification with the database of previous downloads ; measurements can be done with this message and its conclusion which is flagged by \hyperref[DEC050]{\textit{[DEC\_050]}} or \hyperref[DEC060]{\textit{[DEC\_060]}} message.

\label{DEC050}
\subsection{[DEC\_050] Interface Polling Complete / No File(s) Available}
This message is logged upon completion filtering the files published in the download interface and verification of eventual duplications in the database without any \textit{new} file meeting the download rules. It can be used to measure the time required to perform the filtering operations.

\label{DEC060}
\subsection{[DEC\_060] Interface Polling Complete / New File(s) Available}
This message is logged upon completion filtering the files published in the download interface and verification of eventual duplications in the database reporting there are some \textit{new} files for download. It can be used to measure the time required to perform the filtering operations.

\label{DEC105}
\subsection{[DEC\_105] File Available}
The file referenced in the message met any of the filtering rules defined in the configuration \textit{dec\_incoming\_files.xml} and it is therefore available for download from the interface. This message is logged only when the \textit{--list} mode is used, otherwise the files matching the rules are directly downloaded and logged accordingly. 

\label{DEC110}
\subsection{[DEC\_110] File Downloaded}
The file referenced in the message has been downloaded from the interface and placed into the \hyperref[LocalInbox]{\textit{LocalInbox}} associated to such interface. If the same file is available again at the same interface, the DEC will detect a file duplication condition.

\label{DEC115}
\subsection{[DEC\_115] File Disseminated}
The file referenced in the message met any of the and it has been moved from \hyperref[LocalInbox]{\textit{LocalInbox}} into the Intray(s) matching the first \hyperref[Dissemination rules]{\textit{dissemination rule}}.

\subsection{[DEC\_116] File Compressed}
The file referenced in the message has been compressed according to the \hyperref[Dissemination rules]{\textit{dissemination rule}} \textit{Compress} optional configuration item of the \textit{Intray} entity.

\subsection{[DEC\_120] Unknown File Deleted}
According to the configuration item \hyperref[DeleteUnknownFiles]{\textit{DeleteUnknownFiles}} defined in \textit{dec\_config.xml} configuration, a file available in the \textit{pull} interface, which did not match any filtering rule defined in the configuration \textit{dec\_incoming\_files.xml} has been deleted from the \textit{DownloadDirs} \textit{Directory} of such interface it was present.

\subsection{[DEC\_125] Duplicated File Deleted}
According to the configuration item \hyperref[DeleteDuplicatedFiles]{\textit{DeleteDuplicatedFiles}} defined in \textit{dec\_config.xml} configuration, a file available in the \textit{pull} interface, which has been previously downloaded successfully such interface is considered duplicated and it is removed directly in download directory without downloading it.

\label{DEC126}
\subsection{[DEC\_126] Downloaded File Deleted}
According to the configuration item \hyperref[DeleteFlag]{\textit{DeleteFlag}} defined in \textit{dec\_interfaces.xml} for every interface, the file which has been successfully \textit{pulled} is deleted subsequently.

\subsection{[DEC\_130] Event Triggered}
The message traces some event which has been triggered for a given interface according to the configuration items defined in \hyperref[Events]{Events}.

\subsubsection{Event newfile2intray}
This event is triggered upon successful polling completion (cf. \hyperref[DEC060]{DEC\_060}) which drove dissemination of some files (cf. \hyperref[DEC115]{DEC\_115}).
\begin{verbatim}
[DEC_130] LEAP I/F : event newfile2intray => auxConverter -f /S3/Leap_Second.dat
\end{verbatim}

\subsubsection{Event onreceivenewfilesok}
This event is triggered upon successful polling completion (cf. \hyperref[DEC060]{DEC\_060}) which drove download of some files (cf. \hyperref[DEC110]{DEC\_110}).
\begin{verbatim}
[DEC_130] LEAP I/F : event onreceivenewfilesok triggered => echo %f RECEIVED
\end{verbatim}

\subsection{[DEC\_131] Dissemination Command Execution }
The message traces some event which has been triggered for a given interface according to the configuration item \textit{"Execution"} defined in the \hyperref[Dissemination rules]{\textit{dissemination rules}}.

\label{DEC210}
\subsection{[DEC\_210] File Pushed to Interface}
The file referenced in the message has been uploaded to the interface placed into its \hyperref[Upload Rules]{\textit{UploadDir}}.

\label{DEC211}
\subsection{[DEC\_211] Push Setup / File at GlobalOutbox}
TBW.

\label{DEC212}
\subsection{[DEC\_212] Push Setup / File at Removed from SourceDir}
TBW.

\label{DEC213}
\subsection{[DEC\_213] Push Setup / File at Interface LocalOutbox}
TBW.

\label{DEC214}
\subsection{[DEC\_214] Push Setup / File Compressed at Interface LocalOutbox}
TBW.

\label{DEC235}
\subsection{[DEC\_235] Report Generation DeliveredFiles to Interface}
TBW.

\label{DEC240}
\subsection{[DEC\_240] Push Email Notification to Interface}
TBW / decNotify2Interface.

\label{DEC241}
\subsection{[DEC\_241] Push Error Email Notification to Interface}
TBW / decNotify2Interface.

% ------------------------------------------------------------------------------
% Warning Messages

\newpage

\section{Warning Messages}

\subsection{Scope}
The warning messages by DEC SW are meant in general for tracing not nominal situations which might eventually require some intervention.

\subsection{Index of Messages}

\begin{itemize}
	\item \textbf{[DEC\_301]} Detected duplicated file "filename" already received from "interface" I/F
	\item \textbf{[DEC\_320]} Detected unknown file "filename" available at "interface" I/F
	\item \textbf{[DEC\_330]} "filename" is stuck in "temporal" directory
	\item \textbf{[DEC\_331]} "filename" is stuck in LocalInbox directory		
\end{itemize}

\subsection{[DEC\_301] Duplicated File Available}
The file reported is available again at the \textit{pull} interface ; if the inventory is active, DEC retrieves just once a given file from each interface. This message will be reported during every polling iteration unless the \textit{duplicated} file is removed from the interface.

\subsection{[DEC\_320] Unknown File Available}
The file reported is available in the \textit{pull} interface, but did not match any filtering rule defined in the configuration \textit{dec\_incoming\_files.xml}. This message will be repeated every polling iteration unless the \textit{unknown} file is removed from the interface.

\subsection{[DEC\_330] File Stuck in Temporal Directory}
This warning is associated to error message \hyperref[DEC620]{\textit{[DEC\_620]}} informing that the file was successfully downloaded and stuck in the temporal directory available for contingency recovery.

\subsection{[DEC\_331] File Stuck in LocalInbox Directory}
This warning is associated to error message \hyperref[DEC625]{\textit{[DEC\_625]}} or \hyperref[DEC626]{\textit{[DEC\_626]}} informing that the file was successfully downloaded and stuck in the \textit{LocalInbox} directory of some interface due to problems during dissemination.

% ------------------------------------------------------------------------------
% Error Messages

\newpage
\section{Error Messages}

\subsection{Scope}
The error messages by DEC SW are meant in general for tracing problems encountered during one iteration which prevented the complete termination of any circulation rule.

\subsection{Index of Messages}

\begin{itemize}
	\item \textbf{[DEC\_600]} I/F "interface": Could not perform polling
	\item \textbf{[DEC\_610]} I/F "interface": Unable to connect to \hyperref[Config_Server]{"Hostname"} with FTP
	\item \textbf{[DEC\_611]} I/F "interface": reason of the connection failure
	\item \textbf{[DEC\_612]} I/F "interface": Cannot reach directory defined in any of the the \hyperref[DownloadDirs]{"DownloadDirs"}
	\item \textbf{[DEC\_613]} I/F "interface": server message associated to the failure associated to the change of directory
	\item \textbf{[DEC\_614]} I/F "interface": Cannot GET "URL"
	\item \textbf{[DEC\_620]} I/F "interface": Could not copy "file" into local
"directory"
	\item \textbf{[DEC\_625]} Dissemination failure of "file" into intray
"directory" using mv command
	\item \textbf{[DEC\_626]} Dissemination failure of "file" into intray
"directory" using hard-links command
	\item \textbf{[DEC\_666]} I/F "interface": Could not download "file"
	\item \textbf{[DEC\_711]} Could not reach directory from \textit{SourceDir} to fetch files for push
	\item \textbf{[DEC\_713]} Could not place file in  \textit{LocalOutbox} to prepare files out-tray for push	
\end{itemize}


\subsection{[DEC\_600] Failed to Poll Interface}
\label{DEC600}
This message is raised at the end of the interface polling operation to notify failure. Reason should have been previously logged (e.g. \hyperref[DEC610]{DEC\_610}, \hyperref[DEC611]{DEC\_611},etc). Polling elapse time can be computed by referring to the associated \hyperref[DEC005]{DEC\_005} message. 

\subsection{[DEC\_610] Unable to Connect with FTP}
\label{DEC610}
This error is raised when it is not possible to connect to \hyperref[Config_Server]{"Hostname"} with FTP.

\subsection{[DEC\_611] Server Error Message}
\label{DEC611}
This error code can bring different messages associated to the connection failure [DEC\_610] is reporting. Errors can driven by miss-configuration of the \hyperref[Config_Server]{Server} associated to such interface or its unavailability due to network problems.

\subsubsection{Hostname is unknown}
\begin{verbatim}
[DEC_611] LOCALHOST_NOT_SECURE I/F: getaddrinfo: nodename nor servname provided, or not known
\end{verbatim}

\subsubsection{Service not enabled by host}
\begin{verbatim}
[DEC_611] LOCALHOST_NOT_SECURE I/F: Connection refused - connect(2) for 127.0.0.1:21
\end{verbatim}

\subsubsection{Failed authentication}
\begin{verbatim}
[DEC_611] LOCALHOST_NOT_SECURE I/F: 530 Login authentication failed
\end{verbatim}

\subsection{[DEC\_612] Cannot Reach Interface Directory}
\label{DEC612}
Failed to reach one of the \textit{Directory} of the \hyperref[DownloadDirs]{"DownloadDirs"} of a given interface.

\subsection{[DEC\_613] Server Error Message }
The information replied by the server when error condition \hyperref[DEC612]{[DEC\_612]} arises is usually meaningless to understand the root reason to limit the risks of security attacks. It usually is related to file permissions on the server or miss-configuration problems referring to a non existing directory.
\begin{verbatim}
[DEC_613] LOCALHOST I/F: 550 Can't change directory to /a/if/local/: No such file or directory
\end{verbatim}

\subsection{[DEC\_614] Cannot Get URL}
\label{DEC614}
Failed to get the URL associated to one \textit{Directory} of the \hyperref[DownloadDirs]{"DownloadDirs"} of a given interface when using the HTTP protocol.

\subsection{[DEC\_620] Downloaded File not Copied into Final Dir}
\label{DEC620}
The file retrieved from the interface could not be copied into the final directory defined in the configuration. This is usually a problem of file permissions. 

\subsection{[DEC\_625] File Dissemination Failure}
\label{DEC625}
This error is raised when DEC could not disseminate a file into a given \textit{Intray} according to the \hyperref[Dissemination rules]{\textit{Dissemination rules}} using a mv command. This is usually associated to file permission problems of the \textit{Intray} directory.

\subsection{[DEC\_626] File Dissemination Failure}
\label{DEC625}
This error is raised when DEC could not disseminate a file into a given \textit{Intray} according to the \hyperref[Dissemination rules]{\textit{Dissemination rules}} using hard-links. This is usually associated to file permission problems of the \textit{Intray} directory.

\subsection{[DEC\_666] Download Failure}
\label{DEC666}
This error is raised when DEC could not download a file from a given interface.

\label{DEC670}
\subsection{[DEC\_670] Deletion Failure}
This error is raised when DEC could not delete from the interface a file which has been successfully downloaded (cf. \hyperref[DEC110]{\textit{[DEC\_110]}}).
For a given file from a specific interface this message is exclusive to \hyperref[DEC126]{\textit{[DEC\_126]}}.

\label{DEC700}
\subsection{[DEC\_700] Push Failure to Interface}
TBW

\label{DEC711}
\subsection{[DEC\_711] Cannot Reach SourceDir Sub-Directory}
This error is raised when DEC could not reach a \textit{SourceDir} sub-directory to fetch the selected files to \textit{push} according to some \hyperref[Upload Rules]{\textit{[Upload Rule}} miss-configuration.

\label{DEC713}
\subsection{[DEC\_713] File Hard-link Failure into LocalOutbox}
This error is raised .

\label{DEC740}
\subsection{[DEC\_740] Failed to Email Push Email Notification to Interface}
TBW / decNotify2Interface.

\label{DEC741}
\subsection{[DEC\_741] Failed to Email Push Error Notification to Interface}
TBW / decNotify2Interface.

\label{DEC742}
\subsection{[DEC\_742] Email Error}
TBW / decNotify2Interface.

\subsubsection{Credentials Not Accepted}

\begin{verbatim}
[ERROR] 2020-04-14 18:44:38 NODE_1.mail - [DEC_742] LOCALHOST_NOT_SECURE I/F: Username and Password not accepted
\end{verbatim}

\subsubsection{SMTP Server Not Known}

\begin{verbatim}
[ERROR] 2020-04-14 18:49:42 NODE_1.mail - [DEC_742] LOCALHOST_NOT_SECURE I/F: getaddrinfo: nodename nor servname provided, or not known
\end{verbatim}

\subsubsection{Time-Out / Port Miss-configuration}
\begin{verbatim}
[ERROR] 2020-04-14 18:56:31 NODE_1.mail - [DEC_742] LOCALHOST_NOT_SECURE I/F: execution expired
\end{verbatim}

\subsubsection{Need TLS / Secure Flag Miss-configuration}
\begin{verbatim}
[ERROR] 2020-04-14 18:58:58 NODE_1.mail - [DEC_742] LOCALHOST_NOT_SECURE I/F: Must issue a STARTTLS command first
\end{verbatim}

\subsection{TBW}

% ------------------------------------------------------------------------------
% Debug Messages

\newpage
\section{Debug Messages}

\subsection{Scope}
The debug messages by DEC SW are meant in general for troubleshooting purposes when undesired behaviour raises ; for instance it may be useful to activate it when rehearsing new configurations. \newline

\par
\noindent
By default the log debug messages are not generated ; they can be optionally activated at the execution time of the different DEC commands by usage of the \textit{--Debug} or \textit{-D} execution flag supplied at the command line interface.


\subsection{Index of Messages}

\begin{itemize}
	\item \textbf{[DEC\_910]} I/F "interface": Filtering directory with files "number" of items
	\item \textbf{[DEC\_911]} I/F "interface": performance when filtering according to download rules 
	\item \textbf{[DEC\_912]} I/F "interface": performance when filtering according to database
	\item \textbf{[DEC\_913]} I/F "interface": filtering file with database
	\item \textbf{[DEC\_914]} I/F "interface": "file" found in database
	\item \textbf{[DEC\_915]} I/F "interface": "file" not found in database	
	\item \textbf{[DEC\_941]} File dissemination command I
	\item \textbf{[DEC\_942]} File dissemination command II	
	\item \textbf{[DEC\_951]} Removing "file" in "directory" which is \hyperref[LocalInbox]{"LocalInbox"}
\end{itemize}

\subsection{[DEC\_910] Filtering Number of Files in Download Directory}
\label{DEC910}
This message reports the number of files published in the \hyperref[DownloadDirs]{"DownloadDirs"} which are about to be filtered according to the download rules and the database content.

\subsection{[DEC\_911] Filtering According to Download Rules}
\label{DEC911}
This message reports the CPU time resources used to perform the filtering operations.

\label{DEC912}
\subsection{[DEC\_912] Filtering Number of Items with Database}
This message traces the number of files which met the download rules during a given pull iteration and which are about to be filtered with respect to the database registry.

\label{DEC913}
\subsection{[DEC\_913] Filtering File with Database}
This message traces that a file found in the interface, which is matching the download rules, is about to be verified whether it has been previously received or not by checking its name reference in the database. 

\label{DEC914}
\subsection{[DEC\_914] File Found in Database}
This message traces that a file found in the interface, which is matching the download rules, is already registered in the database referring to a previous successful download, and therefore such file will be filtered-out and it will not be pulled again.

\label{DEC915}
\subsection{[DEC\_915] File Not Found in Database}
TBW

\subsection{[DEC\_941] File Dissemination Command I}
\label{DEC941}
This message traces the file-system command used to perform the pulled file \textit{first} dissemination from the Interface \hyperref[LocalInbox]{\textit{"LocalInbox"}} into the first \textit{Intray} configured according to the \hyperref[Dissemination rules]{\textit{Dissemination Rules}}.

\subsection{[DEC\_942] File Dissemination Command II}
\label{DEC942}
This message traces the file-system command used to perform the pulled file \textit{remaining} dissemination(s) from the first \textit{Intray} configured according to the \hyperref[Dissemination rules]{\textit{Dissemination Rules}}.

\subsection{[DEC\_951] Removal from LocalInbox upon Dissemination}
\label{DEC951}
This message reports that the "file" has been removed from the "directory" \hyperref[LocalInbox]{"LocalInbox"} upon a complete dissemination according to the configured rules.

\end{document}

